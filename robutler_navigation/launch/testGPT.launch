<launch>
    <arg name="use_sim_time" default="false"/>
    <arg name="map_file" default="$(find robutler_navigation)/maps/casa/map2.yaml"/>
    <arg name="initial_pose_x" default="0.0"/>
    <arg name="initial_pose_y" default="0.0"/>
    <arg name="initial_pose_a" default="0.0"/>
    <arg name="base_frame_id" default="base_footprint"/>
    <arg name="odom_frame_id" default="odom"/>
    <arg name="global_frame_id" default="map"/>
    <arg name="odom_topic" default="odom" />

    <param name="use_sim_time" value="$(arg use_sim_time)"/>

    <!-- Runs map server -->

    <node name="map_server" pkg="map_server" type="map_server" args="$(arg map_file)" />


    <!-- run the AMCL -->
    <node pkg="amcl" type="amcl" name="amcl" output="screen">
      <param name="odom_frame_id" value="$(arg odom_frame_id)"/>
      <param name="base_frame_id" value="$(arg base_frame_id)"/>
      <param name="global_frame_id" value="$(arg global_frame_id)"/>
      <param name="initial_pose_x" value="$(arg initial_pose_x)"/>
      <param name="initial_pose_y" value="$(arg initial_pose_y)"/>
      <param name="initial_pose_a" value="$(arg initial_pose_a)"/>
      <remap from="odom" to="$(arg odom_topic)"/>
    </node>

    <!-- run the move_base node -->
    <include file="$(find robutler_navigation)/launch/move_base.launch.xml" >
        <arg name="odom_frame_id" value="$(arg odom_frame_id)"/>
        <arg name="base_frame_id" value="$(arg base_frame_id)"/>
        <arg name="global_frame_id" value="$(arg global_frame_id)"/>
        <arg name="odom_topic" value="$(arg odom_topic)"/>
    </include>
</launch>